<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HealthApp Web App Mockup</title>
    <link rel="stylesheet" href="../styles/styles-webapp.css">
</head>
<body>
    <div id="nav-placeholder"></div>
    <script src="../scripts/include-nav.js"></script>
    <main class="webapp-page">
        <h1 class="webapp-hero">Mobile App Demo</h1>
        <div class="mobile-container">
            <div class="mobile-frame">
                <div class="device-notch">
                    <span class="device-speaker"></span>
                    <span class="device-camera"></span>
                </div>
                <div class="device-screen">
                    <section id="screen-login" class="mobile-screen is-active">
                        <h2 class="mobile-header">Login</h2>
                        <div style="margin-bottom:12px;">
                            <input type="text" placeholder="Email" style="width:100%; padding:8px; margin-bottom:8px;" />
                            <input type="password" placeholder="Password" style="width:100%; padding:8px;" />
                        </div>
                        <div style="display:flex; gap:8px;">
                            <button class="btn-secondary" data-target="screen-home">Skip Login</button>
                            <button class="btn-primary" data-target="screen-goals">Log in</button>
                        </div>
                    </section>

                    <section id="screen-goals" class="mobile-screen">
                        <div style="display:flex; align-items:center; gap:8px; margin-bottom:12px;">
                            <button class="btn-back">Back</button>
                            <h2 class="mobile-header" style="margin:0;">Goals</h2>
                        </div>
                        <p>Select your primary health goal:</p>
                        <div style="display:flex; flex-direction:column; gap:8px; margin:12px 0;">
                            <button class="pill" data-target="screen-book">Lose weight</button>
                            <button class="pill" data-target="screen-book">Improve fitness</button>
                            <button class="pill" data-target="screen-book">Manage cholesterol</button>
                        </div>
                        <button class="btn-primary" data-target="screen-book">Skip To Booking</button>
                    </section>

                    <section id="screen-book" class="mobile-screen">
                        <div style="display:flex; align-items:center; gap:8px; margin-bottom:12px;">
                            <button class="btn-back">Back</button>
                            <h2 class="mobile-header" style="margin:0;">Book a Test</h2>
                        </div>
                        <div class="test-card">
                            <h3>Comprehensive Blood Test</h3>
                            <p>Includes CBC, Lipids, Glucose, and more.</p>
                            <div class="price">$99</div>
                        </div>
                        <div style="margin-top:12px; display:flex; gap:8px;">
                            <button class="btn-secondary" data-target="screen-home">Cancel</button>
                            <button class="btn-primary" data-target="screen-review">Review Order</button>
                        </div>
                    </section>

                    <section id="screen-review" class="mobile-screen">
                        <div style="display:flex; align-items:center; gap:8px; margin-bottom:12px;">
                            <button class="btn-back">Back</button>
                            <h2 class="mobile-header" style="margin:0;">Review Order</h2>
                        </div>
                        <div style="margin-bottom:12px;">
                            <div><strong>Comprehensive Blood Test</strong></div>
                            <div style="color:#666;">Quantity: 1</div>
                            <div style="margin-top:8px;">Total: <strong>$99</strong></div>
                        </div>
                        <div style="display:flex; gap:8px;">
                            <button class="btn-secondary" data-target="screen-book">Edit</button>
                            <button class="btn-primary" data-target="screen-payment">Proceed to Payment</button>
                        </div>
                    </section>

                    <section id="screen-payment" class="mobile-screen">
                        <div style="display:flex; align-items:center; gap:8px; margin-bottom:12px;">
                            <button class="btn-back">Back</button>
                            <h2 class="mobile-header" style="margin:0;">Payment</h2>
                        </div>
                        <div style="margin-bottom:12px;">
                            <input type="text" placeholder="Card number" style="width:100%; padding:8px; margin-bottom:8px;" />
                            <div style="display:flex; gap:8px;"><input type="text" placeholder="MM/YY" style="flex:1; padding:8px;" /><input type="text" placeholder="CVC" style="width:80px; padding:8px;" /></div>
                        </div>
                        <div style="display:flex; gap:8px;">
                            <button class="btn-secondary" data-target="screen-review">Back to review</button>
                            <button class="btn-primary" data-target="screen-home">Pay $99</button>
                        </div>
                    </section>

                    <section id="screen-home" class="mobile-screen">
                        <h2 class="mobile-header">Home</h2>
                        <div style="margin:12px 0;">Welcome to your HealthApp home screen.</div>
                        <div style="display:flex; gap:8px; flex-wrap:wrap;">
                            <button class="btn-primary" data-target="screen-book">Book a test</button>
                            <button class="btn-secondary" data-target="screen-goals">Update goals</button>
                        </div>
                    </section>

                    <nav class="bottom-nav">
                        <a data-target="screen-home">Home</a>
                        <a data-target="screen-review">Orders</a>
                        <a data-target="screen-book">Book</a>
                        <a data-target="screen-login">Login</a>
                    </nav>
                </div>
                <div class="device-home-indicator"></div>
            </div>

            <script>
                (function(){
                    const screens = Array.from(document.querySelectorAll('.mobile-screen'));
                    const bottomLinks = Array.from(document.querySelectorAll('.bottom-nav [data-target]'));
                    let historyStack = [];

                    function getActiveScreen() {
                        return screens.find(screen => screen.classList.contains('is-active'));
                    }

                    function setBackVisibility() {
                        document.querySelectorAll('.btn-back').forEach(button => {
                            button.style.display = historyStack.length ? 'inline-flex' : 'none';
                        });
                    }

                    function showScreen(id, pushHistory = true) {
                        const target = document.getElementById(id);
                        if (!target || target.classList.contains('is-active')) {
                            return;
                        }

                        const current = getActiveScreen();
                        if (current && pushHistory) {
                            historyStack.push(current.id);
                        }

                        screens.forEach(screen => {
                            screen.classList.remove('is-active');
                        });

                        target.classList.add('is-active');
                        target.scrollTop = 0;
                        setBackVisibility();
                    }

                    document.body.addEventListener('click', function(event) {
                        const backButton = event.target.closest('.btn-back');
                        if (backButton) {
                            const previous = historyStack.pop();
                            if (previous) {
                                showScreen(previous, false);
                            }
                            setBackVisibility();
                            return;
                        }

                        const trigger = event.target.closest('[data-target]');
                        if (!trigger) {
                            return;
                        }

                        const targetId = trigger.getAttribute('data-target');
                        if (!targetId) {
                            return;
                        }

                        const fromBottomNav = !!trigger.closest('.bottom-nav');
                        if (fromBottomNav) {
                            historyStack = [];
                        }

                        showScreen(targetId, !fromBottomNav);
                        if (fromBottomNav) {
                            setBackVisibility();
                        }
                    });

                    bottomLinks.forEach(link => {
                        link.addEventListener('click', event => event.preventDefault());
                    });

                    historyStack = [];
                    setBackVisibility();
                })();
            </script>
        </div>
    </main>
    <footer>
        <div class="container">
            <p>&copy; 2025 HealthApp. All rights reserved.</p>
        </div>
    </footer>
</body>
</html>
